$.fn.timepicker=function(j){var a={step:30,at_row:6,active_from:"00:00",active_to:"00:00",alarm_from:"00:00",alarm_to:"00:00",alarm_color:"#e73626",lang:"en",select_callback:"",open_callback:"",close_callback:""};

if("string"==typeof j&&"destroy"==j)this.each(function(){1===$(this).next().data("timepicker")&&($(this).next().remove(),$(this).parent().after(this),$(this).prev().remove(),$(this).off("click",this.clickFunc),$(document).off("click",this.documentClick),$(this).removeClass("timepicker_input"))});
else{var a=$.extend({},a,j),h=function(a){a=a.split(":");return parseInt(60*a[0])+parseInt(a[1])};a.active_from=h(a.active_from);a.active_to=h(a.active_to);0==a.active_from&&0==a.active_to&&(a.active_from=a.active_to=-1);a.alarm_from=h(a.alarm_from);a.alarm_to=h(a.alarm_to);0==a.alarm_from&&0==a.alarm_to&&(a.alarm_from=a.alarm_to=-1);

var b=['<div data-timepicker="1" rel="timepickerWindow" style="position:absolute;z-index:9900;display:none;"><div class="reserve-time-dropdown"><table class="reserve-time-table">',
""];b[2]='<td class="time-cell"><a class="possible-reserve-time example" href="#" style="display: none; background:'+a.alarm_color+'">25</a></td><td class="time-cell " colspan="5" style="text-align:left;">'+{ru:{alarm_comment:" - \u0447\u0430\u0441\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441\u043a\u0438\u0434\u043a\u0438"},en:{alarm_comment:""}}[a.lang].alarm_comment+"</td></tr></tbody></table></div></div>";

this.each(function(){this.setPosition=function(a){$(a).css("left",0-a[0].clientWidth/
2+this.clientWidth/2+"px");

$(a).css("top",this.offsetTop+this.offsetHeight+6+"px")};

var c=this;

this.create=function(){1===$(this).next().data("timepicker")&&$(this).next().remove();

$(this).addClass("timepicker_input");

$(this).after('<span class="timepicker-span"></span>').next().append(this).find("input");

$(this).attr("autocomplete","off").attr("readonly","readonly");b[1]="";

for(var j=1440/a.step,e="",m=h($(this).val()),e=new Date,l=h(e.getHours()+":"+e.getMinutes()),k=0;k<j;k++){0==k%a.at_row&&(0!=
k&&(b[1]+="</tr>"),b[1]+="<tr>");

var d=k*a.step,f=parseInt(d/60),g=d%60;10>f&&(f="0"+f);10>g&&(g="0"+g);e=m==d?"active":l<=d&&l+a.step>=d?"user_active":"";if(a.alarm_from<a.alarm_to){if(a.alarm_from<=d&&a.alarm_to>=d&&-1!=a.alarm_from){b[1]+='<td class="time-cell "><a class="possible-reserve-time '+e+'" href="#" style="background:'+a.alarm_color+'">'+f+":"+g+"</a></td>";continue}}else if((a.alarm_from<=d||a.alarm_to>=d)&&-1!=a.alarm_from){b[1]+='<td class="time-cell "><a class="possible-reserve-time '+
e+'" href="#" style="background:'+a.alarm_color+'">'+f+":"+g+"</a></td>";continue}if(a.active_from<a.active_to){if(a.active_from<=d&&a.active_to>=d&&-1!=a.active_from){b[1]+='<td class="time-cell"><a class=" '+e+'" href="#">'+f+":"+g+"</a></td>";continue}}else if((a.active_from<=d||a.active_to>=d)&&-1!=a.active_from){b[1]+='<td class="time-cell"><a class=" '+e+'" href="#">'+f+":"+g+"</a></td>";continue}b[1]+='<td class="time-cell"><a class="no-reserve-time '+e+'" href="#">'+f+":"+g+"</a></td>"}b[1]+=
"</tr>";

$(this).after(b.join().replace(/,/g,"","g"));this.clickFunc=function(){"none"==$(c).next().css("display")?setTimeout(function(){$(c).next().show();c.setPosition($(c).next());a.open_callback&&a.open_callback(c)},10):($(c).next().hide(),a.close_callback&&a.close_callback(c))};$(this).next().find("a").click(function(){if($(this).hasClass("no-reserve-time")||$(this).hasClass("example"))return!1;$(c).next().find("a").removeClass("active");$(this).addClass("active");a.select_callback&&a.select_callback(this);


$(c).val($(this).html());c.clickFunc();
return!1});
this.focused=0;$(this).next().mouseover(function(){c.focused=1}).mouseout(function(){c.focused=0});this.documentClick=function(){!c.focused&&"none"!=$(c).next().css("display")&&($(c).next().hide(),a.close_callback&&a.close_callback(c))};$(document).on("click",this.documentClick);$(document).keydown(function(b){27==b.keyCode&&"none"!=$(c).css("display")&&($(c).next().hide(),a.close_callback&&a.close_callback(c))})};this.create();$(this).on("click",c.clickFunc)});
return!0}};